(()=>{var v=Object.defineProperty;var O=(o,n)=>{for(var r in n)v(o,r,{get:n[r],enumerable:!0})};var P={};O(P,{client:()=>A,formdata:()=>g,metroError:()=>f,request:()=>p,response:()=>S,symbols:()=>s,trace:()=>U,url:()=>b});var d="https://metro.muze.nl/details/",s={isProxy:Symbol("isProxy"),source:Symbol("source")},l=class o{#e={url:typeof window<"u"?window.location:"https://localhost"};#r=["get","post","put","delete","patch","head","options","query"];static tracers={};constructor(...n){for(let r of n)if(typeof r=="string"||r instanceof String)this.#e.url=""+r;else if(r instanceof o)Object.assign(this.#e,r.#e);else if(r instanceof Function)this.#t([r]);else if(r&&typeof r=="object")for(let e in r)e=="middlewares"?this.#t(r[e]):typeof r[e]=="function"?this.#e[e]=r[e](this.#e[e],this.#e):this.#e[e]=r[e];this.#e.verbs&&(this.#r=this.#e.verbs,delete this.#e.verbs);for(let r of this.#r)this[r]=async function(...e){return this.fetch(p(this.#e,...e,{method:r.toUpperCase()}))};Object.freeze(this)}#t(n){typeof n=="function"&&(n=[n]);let r=n.findIndex(e=>typeof e!="function");if(r>=0)throw f("metro.client: middlewares must be a function or an array of functions "+d+"client/invalid-middlewares-value/",n[r]);Array.isArray(this.#e.middlewares)||(this.#e.middlewares=[]),this.#e.middlewares=this.#e.middlewares.concat(n)}fetch(n,r){if(n=p(n,r),!n.url)throw f("metro.client."+n.method.toLowerCase()+": Missing url parameter "+d+"client/missing-url-param/",n);if(r||(r={}),typeof r!="object"||Array.isArray(r)||r instanceof String)throw f("metro.client.fetch: Options is not an object");let t=[async function(c){c[s.isProxy]&&(c=c[s.source]);let h=await fetch(c);return S(h)}].concat(this.#e?.middlewares?.slice()||[]);r=Object.assign({},this.#e,r);let a;for(let i of t)a=function(c,h){return async function(k){let m,x=Object.values(o.tracers);for(let u of x)u.request&&u.request.call(u,k,h);m=await h(k,c);for(let u of x)u.response&&u.response.call(u,m,h);return m}}(a,i);return a(n)}with(...n){return new o(this,...n)}};function A(...o){return new l(...o)}function w(o,n){let r=n.body;return r||(o===null?r=new ReadableStream:o instanceof ReadableStream?r=o:o instanceof Blob?r=o.stream():r=new ReadableStream({start(e){let t;switch(typeof o){case"object":if(typeof o.toString=="function")t=o.toString();else if(o instanceof FormData)t=new URLSearchParams(o).toString();else if(o instanceof ArrayBuffer||ArrayBuffer.isView(o))t=o;else throw f("Cannot convert body to ReadableStream",o);break;case"string":case"number":case"boolean":t=o;break;default:throw f("Cannot convert body to ReadableStream",o)}e.enqueue(t),e.close()}})),new Proxy(r,{get(e,t,a){switch(t){case s.isProxy:return!0;case s.source:return o;case"toString":return function(){return""+o}}if(typeof o=="object"&&t in o)return typeof o[t]=="function"?function(...i){return o[t].apply(o,i)}:o[t];if(t in e&&t!="toString")return typeof e[t]=="function"?function(...i){return e[t].apply(e,i)}:e[t]},has(e,t){return t in o},ownKeys(e){return Reflect.ownKeys(o)},getOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(o,t)}})}function L(o,n){let r=n||{};!r.url&&n.url&&(r.url=n.url);for(let e of["method","headers","body","mode","credentials","cache","redirect","referrer","referrerPolicy","integrity","keepalive","signal","priority","url"])if(typeof o[e]=="function")o[e](r[e],r);else if(typeof o[e]<"u")if(e=="url")r.url=b(r.url,o.url);else if(e=="headers"){r.headers=new Headers(n.headers),o.headers instanceof Headers||(o.headers=new Headers(o.headers));for(let[t,a]of o.headers.entries())r.headers.set(t,a)}else r[e]=o[e];return r}function p(...o){let n={url:typeof window<"u"?window.location:"https://localhost/",duplex:"half"};for(let t of o)typeof t=="string"||t instanceof URL||t instanceof URLSearchParams?n.url=b(n.url,t):t&&(t instanceof FormData||t instanceof ReadableStream||t instanceof Blob||t instanceof ArrayBuffer||t instanceof DataView)?n.body=t:t&&typeof t=="object"&&Object.assign(n,L(t,n));let r=n.body;r&&typeof r=="object"&&!(r instanceof String)&&!(r instanceof ReadableStream)&&!(r instanceof Blob)&&!(r instanceof ArrayBuffer)&&!(r instanceof DataView)&&!(r instanceof FormData)&&!(r instanceof URLSearchParams)&&(typeof TypedArray>"u"||!(r instanceof TypedArray))&&(n.body=JSON.stringify(r));let e=new Request(n.url,n);return Object.freeze(e),new Proxy(e,{get(t,a,i){switch(a){case s.source:return t;case s.isProxy:return!0;case"with":return function(...c){return r&&c.unshift({body:r}),p(t,...c)};case"toString":case"toJSON":return function(){return t[a].apply(t)};case"blob":case"text":case"json":return function(){return t[a].apply(t)};case"body":if(r||(r=t.body),r)return r[s.isProxy]?r:w(r,t);break}return t[a]}})}function R(o,n){let r=n||{};!r.url&&n.url&&(r.url=n.url);for(let e of["status","statusText","headers","body","url","type","redirected"])typeof o[e]=="function"?o[e](r[e],r):typeof o[e]<"u"&&(e=="url"?r.url=new URL(o.url,r.url||"https://localhost/"):r[e]=o[e]);return r}function S(...o){let n={};for(let e of o)typeof e=="string"?n.body=e:e instanceof Response?Object.assign(n,R(e,n)):e&&typeof e=="object"&&(e instanceof FormData||e instanceof Blob||e instanceof ArrayBuffer||e instanceof DataView||e instanceof ReadableStream||e instanceof URLSearchParams||e instanceof String||typeof TypedArray<"u"&&e instanceof TypedArray?n.body=e:Object.assign(n,R(e,n)));let r=new Response(n.body,n);return Object.freeze(r),new Proxy(r,{get(e,t,a){switch(t){case s.isProxy:return!0;case s.source:return e;case"with":return function(...i){return S(e,...i)};case"body":return n.body?n.body[s.isProxy]?n.body:w(n.body,e):w("",e);case"ok":return e.status>=200&&e.status<400;case"headers":return e.headers;default:if(t in n&&t!="toString")return n[t];if(t in e&&t!="toString")return typeof e[t]=="function"?function(...i){return e[t].apply(e,i)}:e[t];break}}})}function j(o,n){typeof n=="function"?n(o.searchParams,o):(n=new URLSearchParams(n),n.forEach((r,e)=>{o.searchParams.append(e,r)}))}function b(...o){let n=["hash","host","hostname","href","password","pathname","port","protocol","username","search","searchParams"],r=new URL("https://localhost/");for(let e of o)if(typeof e=="string"||e instanceof String)r=new URL(e,r);else if(e instanceof URL||typeof Location<"u"&&e instanceof Location)r=new URL(e);else if(e instanceof URLSearchParams)j(r,e);else if(e&&typeof e=="object")for(let t in e)if(t=="search")typeof e.search=="function"?e.search(r.search,r):r.search=new URLSearchParams(e.search);else if(t=="searchParams")j(r,e.searchParams);else{if(!n.includes(t))throw f("metro.url: unknown url parameter "+d+"url/unknown-param-name/",t);if(typeof e[t]=="function")e[t](r[t],r);else if(typeof e[t]=="string"||e[t]instanceof String||typeof e[t]=="number"||e[t]instanceof Number||typeof e[t]=="boolean"||e[t]instanceof Boolean)r[t]=""+e[t];else if(typeof e[t]=="object"&&e[t].toString)r[t]=e[t].toString();else throw f("metro.url: unsupported value for "+t+" "+d+"url/unsupported-param-value/",o[t])}else throw f("metro.url: unsupported option value "+d+"url/unsupported-option-value/",e);return Object.freeze(r),new Proxy(r,{get(e,t,a){switch(t){case s.isProxy:return!0;case s.source:return e;case"with":return function(...i){return b(e,...i)};case"toString":case"toJSON":return function(){return e[t]()}}return e[t]}})}function g(...o){var n=new FormData;for(let r of o)if(r instanceof FormData)for(let e of r.entries())n.append(e[0],e[1]);else if(r&&typeof r=="object")for(let e of Object.entries(r))if(Array.isArray(e[1]))for(let t of e[1])n.append(e[0],t);else n.append(e[0],e[1]);else throw new f("metro.formdata: unknown option type, only FormData or Object supported",r);return Object.freeze(n),new Proxy(n,{get:(r,e,t)=>{switch(e){case s.isProxy:return!0;case s.source:return r;case"with":return function(...a){return g(r,...a)};case"toString":case"toJSON":return function(){return r[e]()}}return r[e]}})}var y={error:(o,...n)=>{console.error("\u24C2\uFE0F  ",o,...n)},info:(o,...n)=>{console.info("\u24C2\uFE0F  ",o,...n)},group:o=>{console.group("\u24C2\uFE0F  "+o)},groupEnd:o=>{console.groupEnd("\u24C2\uFE0F  "+o)}};function f(o,...n){return y.error(o,...n),new Error(o,...n)}var U={add(o,n){l.tracers[o]=n},delete(o){delete l.tracers[o]},clear(){l.tracers={}},group(){let o=0;return{request:(n,r)=>{o++,y.group(o),y.info(n?.url,n,r)},response:(n,r)=>{y.info(n?.body?n.body[s.source]:null,n,r),y.groupEnd(o),o--}}}};window.metro=P;})();
